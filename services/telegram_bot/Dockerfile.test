FROM python:3.12-slim

WORKDIR /app

# Install test dependencies
RUN pip install pytest pytest-asyncio pytest-cov httpx

# Copy shared module
COPY shared /app/shared
RUN pip install /app/shared

# Copy requirements
COPY services/telegram_bot/requirements.lock ./
RUN pip install -r requirements.lock

# Copy source
COPY services/telegram_bot/src ./src
COPY services/telegram_bot/tests ./tests

CMD ["pytest", "-v"]
