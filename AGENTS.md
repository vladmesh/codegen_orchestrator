# Agents Playbook

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –Ω–∞–¥ —ç—Ç–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º.

## üó∫ –ù–∞–≤–∏–≥–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ |
|----------|------------|
| [README.md](README.md) | –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞, —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ |
| [ARCHITECTURE.md](ARCHITECTURE.md) | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, state schema, –≥—Ä–∞—Ñ |
| [docs/NODES.md](docs/NODES.md) | –û–ø–∏—Å–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤-—É–∑–ª–æ–≤ LangGraph |
| [docs/backlog.md](docs/backlog.md) | –ë—ç–∫–ª–æ–≥ –∑–∞–¥–∞—á –∏ roadmap |

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –Ø–∑—ã–∫ | Python 3.12 |
| –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è | LangGraph |
| LLM | OpenAI / Anthropic |
| –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | python-telegram-bot |
| –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è | PostgreSQL |

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
codegen_orchestrator/
‚îú‚îÄ‚îÄ README.md           # –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ AGENTS.md          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ ARCHITECTURE.md    # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ NODES.md       # –û–ø–∏—Å–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤-—É–∑–ª–æ–≤
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ graph/         # LangGraph: –≥—Ä–∞—Ñ, —É–∑–ª—ã, —Ä—ë–±—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ agents/        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ tools/         # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ telegram/      # –¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç
‚îú‚îÄ‚îÄ tests/
‚îî‚îÄ‚îÄ pyproject.toml
```

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ –Ω–∞–¥ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–∞—Å—Ç–æ –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑:

- **service-template** (`/home/vlad/projects/service-template`) ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
- **prod_infra** (`/home/vlad/projects/prod_infra`) ‚Äî Ansible playbooks –¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## ‚ö†Ô∏è CRITICAL: –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π default values:**

```python
# ‚ùå –ü–ª–æ—Ö–æ
api_key = os.getenv("OPENAI_API_KEY", "sk-test")

# ‚úÖ –•–æ—Ä–æ—à–æ
api_key = os.getenv("OPENAI_API_KEY")
if not api_key:
    raise RuntimeError("OPENAI_API_KEY is not set")
```

### LangGraph —É–∑–ª—ã

–ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è state:

```python
from typing import TypedDict

class OrchestratorState(TypedDict):
    messages: list
    current_project: str | None
    # ...

def architect_agent(state: OrchestratorState) -> OrchestratorState:
    # –õ–æ–≥–∏–∫–∞ –∞–≥–µ–Ω—Ç–∞
    return {"messages": [...], ...}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ `src/agents/<name>.py`
2. –î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª –≤ –≥—Ä–∞—Ñ (`src/graph/graph.py`)
3. –î–æ–±–∞–≤–∏—Ç—å —Ä—ë–±—Ä–∞ (–≤—Ö–æ–¥—è—â–∏–µ –∏ –∏—Å—Ö–æ–¥—è—â–∏–µ)
4. –û–ø–∏—Å–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ –≤ `docs/NODES.md`
5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ `tests/agents/test_<name>.py`

## üîÑ Makefile –∫–æ–º–∞–Ω–¥—ã

```bash
# TODO: –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
make lint      # –õ–∏–Ω—Ç–µ—Ä—ã
make test      # –¢–µ—Å—Ç—ã
make run       # –ó–∞–ø—É—Å–∫ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
```

## üß† –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ –Ω–∞–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ–π –∑–∞–≥—Ä—É–∂–∞–π —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã:

- **–ù–æ–≤—ã–π –∞–≥–µ–Ω—Ç**: `ARCHITECTURE.md`, `docs/NODES.md`, `src/agents/`
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å service-template**: `/home/vlad/projects/service-template/docs/ARCHITECTURE.md`
- **–¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç**: `src/telegram/`
